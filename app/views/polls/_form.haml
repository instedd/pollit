#poll_form_container
  = form_for @poll, :html => {:id => 'poll_form'} do |f|
    = errors_for @poll

    .box.plain.grey
      .field
        = f.label :form_url, "Import form from Google Forms"
        %p Copy the live form URL (not the spreadsheet's URL) making sure the form does not require sign-in
        = f.text_field :form_url, :class => 'w50'
        = fancy_button 'Import form', 'fimport', :class => 'import_form_action'
        = f.hidden_field :post_url

    %h2 Properties

    .field
      = f.label :title
      = f.text_field :title, :class => 'required w60'
    
    .field
      = f.label :description
      = f.text_area :description, :class => 'w60', :rows => 5
    
    .field
      = f.label :welcome_message
      %p This message will be sent to all respondents asking them if they agree to participate in the poll
      = f.text_area :welcome_message, :size => "28x5", :maxlength => 140, :class => 'required ux-wajbar w60'
    .field
      = f.label :confirmation_word
      %p Respondents must answer with the confirmation word in order to agree to participate in the poll
      = f.text_field :confirmation_word, :class => 'w60'
    .field
      = f.label :goodbye_message
      %p This message will be sent to respondents when they complete the poll
      = f.text_area :goodbye_message, :size => "28x5", :maxlength => 140, :class => 'ux-wajbar w60'
    
    %hr

    %h2 Poll questions
    - if f.object.questions.empty?
      .field
        %p 
          %a{:href => '#', :onclick => '$("input[name=\'poll[form_url]\']").focus(); return false;'}
            Import a form from Google 
          to load its questions
    -else
      = fancy_button 'Reload form from Google', 'fsync', :class => 'import_form_action reload_from_google block'
      -#HACK: Use this hidden field to run client-side validation on all questions checking for errors
      = hidden_field_tag :questions_validation, ''
      = render :partial => 'polls/form_editor/questions', :locals => { :f => f, :disabled => true }


    = grey_button "Create"
    = white_link_to "Cancel", polls_path